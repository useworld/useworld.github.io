---
layout : post
title : 악성코드 분석
---

### Service

> exe - services.exe
>
> dll - svchost.exe
>
> services.exe 하위에 svchost.exe 존재
>
> 위장하기 위한 악성코드가 svchost.exe 인 경우 services.exe 하위가 아닌 따로 processl ist에 존재
>
> 작업관리자는 부모관계 알 수 없음
>
> process explorer 사용

<br>

### RVA to RAW

> OllyDbg - 메모리
>
> IDA - 파일
>
> 디버깅 중 디어셈블된 코드를 보고 싶을때 위치를 찾기 위해 계산

<br>

### Ubuntu GDB 실습

> nasm -felf32 hello.asm 
>
> ld -I/lib/ld-linux.so.2 -lc --entry main hello.o
>
> nasm -felf32 exam1.asm
>
> ld --entry main exam1.asm
>
> nasm -felf32 exam2.asm && ld --entry main exam2.o
>
> objdump -d a.out
>
> <br>
>
> gdb -q a.out 
>
> set disassembly-flavor intel - Intel 스타일로 바꾸기
>
> b main - BreakPoint
>
> ni - Next Instruction
>
> info reg - Information Register
>
> x/x - 데이터 보기
>
> x/10x - 10개 보기
>
> x/bx - 데이터를 byte로
>
> x/wx - 데이터를 word로

<br>

### OllyDbg

>F2 : Breakpoint
>
>F7 : Step into
>
>F8 : Step over
>
>F9 : Run
>
>Ctrl + F9 : Return
>
>Ctrl + F2 : Restart

<br>

Visual Studio 2015 Configuration

>**Project Properties**
>
>C/C++
>
>- Code Generation
>  - Enable Minimal Rebuild : No
>  - Enable C++ Exceptions : No
>  - Basic Runtime Checks : Default
>  - Security Check : Disable Security Check
>- Optimization
>  - Optimization : Disabled
>- Advanced
>  - Compile As : Compile as C Code
>
>Linker
>
>- General
>  - Enable Incremental Linking : No
>
>- Advanced
>  - Randomized Base Address : No
>  - Data Execution Prevention : No



Rundll32.exe DLL파일,Export API

뮤텍스, 세마포어